<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <h2 mat-dialog-title>{{ 'inventory.dialog_title' | translate }}</h2>
  
  <mat-dialog-content>
    <!-- Action Type Selection -->
    <mat-form-field>
      <mat-label>{{ 'inventory.action_type' | translate }}</mat-label>
      <mat-select formControlName="action">
        <mat-option *ngFor="let action of actionTypes" [value]="action">
          {{ 'inventory.action.' + action.toLowerCase() | translate }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Storage Specific Fields -->
    <ng-container *ngIf="selectedAction === 'STORAGE'">
      <mat-form-field>
        <mat-label>{{ 'inventory.product' | translate }}</mat-label>
        <mat-select formControlName="productId">
          <mat-option *ngFor="let product of products" [value]="product.id">
            {{ product.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.quantity' | translate }}</mat-label>
        <input matInput type="number" formControlName="quantity">
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.license' | translate }}</mat-label>
        <input matInput formControlName="license">
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.purchase_contract' | translate }}</mat-label>
        <mat-select formControlName="purchaseContractId">
          <mat-option *ngFor="let contract of contracts" [value]="contract.id">
            {{ contract.contractNo }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.storage_time' | translate }}</mat-label>
        <input matInput [matDatepicker]="storagePicker" formControlName="storageTime">
        <mat-datepicker-toggle matSuffix [for]="storagePicker"></mat-datepicker-toggle>
        <mat-datepicker #storagePicker></mat-datepicker>
      </mat-form-field>
    </ng-container>

    <!-- Outbound/Borrow Specific Fields -->
    <ng-container *ngIf="selectedAction === 'OUTBOUND' || selectedAction === 'BORROW'">
      <mat-form-field>
        <mat-label>{{ 'inventory.out_time' | translate }}</mat-label>
        <input matInput [matDatepicker]="outPicker" formControlName="outTime">
        <mat-datepicker-toggle matSuffix [for]="outPicker"></mat-datepicker-toggle>
        <mat-datepicker #outPicker></mat-datepicker>
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.handling_employee' | translate }}</mat-label>
        <mat-select formControlName="handlingEmployeeId">
          <mat-option *ngFor="let employee of employees" [value]="employee.id">
            {{ employee.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.shipping_method' | translate }}</mat-label>
        <mat-select formControlName="shippingMethod">
          <mat-option *ngFor="let method of shippingMethods" [value]="method">
            {{ 'shipping_method.' + method.toLowerCase() | translate }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.shipping_address' | translate }}</mat-label>
        <input matInput formControlName="shippingAddress">
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.receiver_name' | translate }}</mat-label>
        <input matInput formControlName="receiverName">
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.receiver_phone' | translate }}</mat-label>
        <input matInput formControlName="receiverPhone">
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'inventory.express_tracking_number' | translate }}</mat-label>
        <input matInput formControlName="expressTrackingNumber">
      </mat-form-field>
    </ng-container>

    <!-- Common Remarks Field -->
    <mat-form-field>
      <mat-label>{{ 'inventory.remarks' | translate }}</mat-label>
      <textarea matInput formControlName="remarks"></textarea>
    </mat-form-field>
  </mat-dialog-content>

  <mat-dialog-actions>
    <button mat-button (click)="onCancel()">{{ 'common.cancel' | translate }}</button>
    <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || loading">
      {{ 'common.submit' | translate }}
    </button>
  </mat-dialog-actions>
</form>
